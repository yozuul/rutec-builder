import{E as $}from"./el-input.57265631.js";import{E as j,a as R}from"./el-form.57c19d47.js";import{E as z,a as G}from"./el-select.4f2e1a40.js";import{E as H,a as L}from"./el-checkbox.45ac3761.js";import{E as J}from"./el-button.05de3bc9.js";import{a as K}from"./layout.ba9fe5d1.js";import"./base.aaa84ba8.js";import"./el-scrollbar.82b407f2.js";import"./el-popper.3bd3cc02.js";/* empty css                          */import{E}from"./el-notification.663e6eba.js";import{I as Q}from"./index.2048010d.js";import{u as W}from"./partnerStore.b7f43263.js";import{p as X,s as A,r as Y,v as w,b as Z,o as u,c as d,e as n,f as o,u as a,k as D,F as P,l as U,m as C,j as T}from"./entry.7f028a03.js";const ce=X({__name:"PartnerAddEdit",props:{cardTitle:{type:String},partnerData:{type:Object}},async setup(v){let g,V;const c=v,y=W();[g,V]=A(()=>y.fetchCountry()),await g,V(),[g,V]=A(()=>y.fetchCity()),await g,V();const F=y.cities,S=y.country,k=Y(),e=w({companyName:"",companyType:"",country:"",city:"",adress:"",newCityData:"",companyAreas:10,experience:0,companySpec:[],email:"",phone:"",companyEmployee:"",employeePosition:"",status:"Одобрен"}),m=w({newCityData:!1,companyAreas:!1,companyEmployee:!1,employeePosition:!1});function b(){m.newCityData=!1,m.companyAreas=!1,m.companyEmployee=!1,m.employeePosition=!1,e.city==="Новый город"&&(m.newCityData=!0),x()}Z(()=>{if(c.partnerData){const r=c.partnerData;console.log("partner",r),e.companyName=r.companyName,e.companyType=r.companyType,e.country=r.country.name,e.city=r.city.name,e.adress=r.adress,e.companySpec=r.companySpec,e.companyAreas=r.companyAreas,e.experience=r.experience,e.email=r.email,e.phone=r.phone,e.companyEmployee=r.companyEmployee,e.employeePosition=r.employeePosition,e.status=r.status,x(),console.log(r)}const s=document.querySelector(".phoneMask .el-input__inner");s&&Q(s,{mask:"+{7} (000) 000-00-00"})});function x(){e.companyType==="Предприятие"&&(m.companyAreas=!0,m.companyEmployee=!0,m.employeePosition=!0)}const N=w({companyName:[{required:!0,message:"Название обязательно",trigger:"blur"}],companyType:[{required:!0,message:"Тип обязателен",trigger:"blur"}],city:[{required:!0,message:"Город обязателен",trigger:"change"}],adress:[{required:!0,message:"Адрес обязателен",trigger:"change"}],newCityData:[{required:!0,message:"Укажите название города",trigger:"change"}],companySpec:[{required:!0,message:"Укажите тип обслуживаемых авто",trigger:"change"}],companyEmployee:[{required:!0,message:"Укажите свое Ф.И.О.",trigger:"change"}],employeePosition:[{required:!0,message:"Укажите свою должность",trigger:"change"}],email:[{required:!0,message:"Email обязателен",trigger:"blur"},{type:"email",message:"Укажите корректный email",trigger:["blur","change"]}]}),q=async s=>{s&&await s.validate(async(t,r)=>{if(t){if(!c.partnerData)try{await y.addPartner(e),E({title:"Готово",message:"Партнёр успешно добавлен",type:"success"})}catch{E({title:"Ошибка",message:"Не могли добавить партнёра :(",type:"error"})}if(c.partnerData)try{await y.updatePartner(c.partnerData.id,e),E({title:"Готово",message:"Партнёр успешно обновлён",type:"success"})}catch{E({title:"Ошибка",message:"Не могли обновить партнёра :(",type:"error"})}}else console.log("error submit!",r)})},B=s=>{s&&(s.resetFields(),e.city="")};return(s,t)=>{const r=$,p=j,i=z,_=G,f=H,I=L,h=J,M=R,O=K;return u(),d(O,{title:v.cardTitle},{default:n(()=>[o(M,{ref_key:"ruleFormRef",ref:k,model:a(e),rules:a(N),"label-width":"170px",size:"default",class:"partnersForm","status-icon":""},{default:n(()=>[o(p,{label:"Наименование",prop:"companyName"},{default:n(()=>[o(r,{modelValue:a(e).companyName,"onUpdate:modelValue":t[0]||(t[0]=l=>a(e).companyName=l),placeholder:"Название компании"},null,8,["modelValue"])]),_:1}),o(p,{label:"Тип",prop:"companyType"},{default:n(()=>[o(_,{modelValue:a(e).companyType,"onUpdate:modelValue":t[1]||(t[1]=l=>a(e).companyType=l),onChange:b,placeholder:a(e).companyType?a(e).companyType:"Тип компании"},{default:n(()=>[o(i,{label:"Магазин",value:"Магазин"}),o(i,{label:"Автосервис",value:"Автосервис"}),o(i,{label:"Предприятие",value:"Предприятие"})]),_:1},8,["modelValue","placeholder"])]),_:1}),o(p,{label:"Страна",prop:"country"},{default:n(()=>[o(_,{modelValue:a(e).country,"onUpdate:modelValue":t[2]||(t[2]=l=>a(e).country=l),placeholder:a(e).country?a(e).country:"Выберите страну",onChange:b,filterable:""},{default:n(()=>[(u(!0),D(P,null,U(a(S),l=>(u(),d(i,{key:l.id,label:l.name,value:l.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1}),o(p,{label:"Город",prop:"city"},{default:n(()=>[o(_,{modelValue:a(e).city,"onUpdate:modelValue":t[3]||(t[3]=l=>a(e).city=l),placeholder:a(e).city?a(e).city:"Выберите город",onChange:b,filterable:""},{default:n(()=>[(u(!0),D(P,null,U(a(F),l=>(u(),d(i,{key:l.id,label:l.name,value:l.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1}),a(m).newCityData?(u(),d(p,{key:0,onChange:b,label:"Новый город",prop:"newCityData"},{default:n(()=>[o(r,{modelValue:a(e).newCityData,"onUpdate:modelValue":t[4]||(t[4]=l=>a(e).newCityData=l),placeholder:"Город"},null,8,["modelValue"])]),_:1})):C("",!0),o(p,{label:"Адрес",prop:"adress"},{default:n(()=>[o(r,{modelValue:a(e).adress,"onUpdate:modelValue":t[5]||(t[5]=l=>a(e).adress=l),placeholder:"Адрес компании"},null,8,["modelValue"])]),_:1}),a(m).companyAreas?(u(),d(p,{key:1,label:"Вид деятельности",prop:"companyAreas"},{default:n(()=>[o(r,{modelValue:a(e).companyAreas,"onUpdate:modelValue":t[6]||(t[6]=l=>a(e).companyAreas=l),placeholder:"Сфера деятельности предприятия"},null,8,["modelValue"])]),_:1})):C("",!0),o(p,{label:"Опыт работы",prop:"experience"},{default:n(()=>[o(r,{modelValue:a(e).experience,"onUpdate:modelValue":t[7]||(t[7]=l=>a(e).experience=l),placeholder:"0",formatter:l=>l.replace(/\D/g,"")},null,8,["modelValue","formatter"])]),_:1}),o(p,{label:"Вид транспорта",prop:"companySpec"},{default:n(()=>[o(I,{modelValue:a(e).companySpec,"onUpdate:modelValue":t[8]||(t[8]=l=>a(e).companySpec=l)},{default:n(()=>[o(f,{label:"Легковой",name:"type"}),o(f,{label:"Грузовой",name:"type"}),o(f,{label:"Коммерческий транспорт",name:"type"}),o(f,{label:"Специальная техника",name:"type"}),o(f,{label:"Все виды транспорта",name:"type"})]),_:1},8,["modelValue"])]),_:1}),a(m).companyEmployee?(u(),d(p,{key:2,label:"Представитель",prop:"companyEmployee"},{default:n(()=>[o(r,{modelValue:a(e).companyEmployee,"onUpdate:modelValue":t[9]||(t[9]=l=>a(e).companyEmployee=l),placeholder:"Ф.И.О. представителя компании"},null,8,["modelValue"])]),_:1})):C("",!0),a(m).employeePosition?(u(),d(p,{key:3,label:"Должность",prop:"employeePosition"},{default:n(()=>[o(r,{modelValue:a(e).employeePosition,"onUpdate:modelValue":t[10]||(t[10]=l=>a(e).employeePosition=l),placeholder:"Занимаемая должность"},null,8,["modelValue"])]),_:1})):C("",!0),o(p,{label:"Количество авто",prop:"companyAreas"},{default:n(()=>[o(r,{modelValue:a(e).companyAreas,"onUpdate:modelValue":t[11]||(t[11]=l=>a(e).companyAreas=l),placeholder:"шт"},null,8,["modelValue"])]),_:1}),o(p,{label:"Email",prop:"email"},{default:n(()=>[o(r,{modelValue:a(e).email,"onUpdate:modelValue":t[12]||(t[12]=l=>a(e).email=l),placeholder:"Электронная почта"},null,8,["modelValue"])]),_:1}),o(p,{label:"Телефон",prop:"phone",class:"phoneMask"},{default:n(()=>[o(r,{modelValue:a(e).phone,"onUpdate:modelValue":t[13]||(t[13]=l=>a(e).phone=l),placeholder:"Телефон"},null,8,["modelValue"])]),_:1}),o(p,{label:"Статус",prop:"status"},{default:n(()=>[o(_,{modelValue:a(e).status,"onUpdate:modelValue":t[14]||(t[14]=l=>a(e).status=l),placeholder:"Статус"},{default:n(()=>[o(i,{label:"Ожидает",value:"Ожидает"}),o(i,{label:"Одобрен",value:"Одобрен"}),o(i,{label:"Отклонён",value:"Отклонён"})]),_:1},8,["modelValue"])]),_:1}),o(p,null,{default:n(()=>[o(h,{type:"primary",onClick:t[15]||(t[15]=l=>q(a(k)))},{default:n(()=>[T("Сохранить")]),_:1}),o(h,{onClick:t[16]||(t[16]=l=>B(a(k)))},{default:n(()=>[T("Очистить")]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])}}});export{ce as _};
