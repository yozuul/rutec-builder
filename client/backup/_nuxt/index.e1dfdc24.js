import{_ as Se}from"./PublicNavi.vue.b60c2a04.js";import{E as Y}from"./el-input.af81951a.js";import{C as K,r as y,L as Ie,a as P,p as S,A as q,o as _,k as g,h as f,a4 as Z,ak as Q,u as e,i as X,D as F,G as H,j as A,t as x,J as ee,Y as oe,E as Pe,a1 as $e,b as le,R as Be,v as M,a2 as Ce,w as we,f as b,e as k,F as I,al as Ue,ab as Te,m as $,s as L,l as T,c as C}from"./entry.18e2495c.js";import{b as O,n as W,q as J,I as Ae,E as Ne}from"./index.4edc3df1.js";import{v as te,d as Le,a as Oe,b as ze,f as Me,E as ne}from"./el-button.4b28c0d2.js";import{U as G,C as qe}from"./event.9519ab40.js";import{_ as D,w as He,b as ae}from"./base.2bb6cb54.js";import{d as Ge}from"./aria.e146d83a.js";import{E as se,a as De}from"./el-checkbox.2154bfa8.js";import{E as je,a as Ke}from"./el-form.384ff32a.js";import{s as We}from"./fetch-data.87f96ffe.js";import{a as Je,n as Ye}from"./notify.451191a9.js";import{E as re}from"./el-card.c774d930.js";import"./partnerStore.d9878ca3.js";import{u as Ze}from"./promoStore.d434ca63.js";import{u as j}from"./fetch.90a3c0c3.js";/* empty css                          *//* empty css                */import{g as Qe}from"./field-id-sorter.b437f58c.js";import{c as Xe}from"./convert-products-fields.6a8f9e75.js";import{E as eo}from"./el-message.6dbc9361.js";import"./el-menu.a0e2a947.js";import"./vnode.21d4e520.js";import"./el-popper.8acabd0f.js";import"./typescript.defaf979.js";import"./el-tooltip.4ed993c7.js";import"./isEqual.da90e6c9.js";import"./_Uint8Array.bec00609.js";import"./_initCloneObject.e22dfabd.js";import"./el-notification.7627f0c4.js";import"./api.config.665f63bb.js";import"./cookie.3290b875.js";const ie=O({size:te,disabled:Boolean,label:{type:[String,Number,Boolean],default:""}}),oo=O({...ie,modelValue:{type:[String,Number,Boolean],default:""},name:{type:String,default:""},border:Boolean}),ue={[G]:a=>K(a)||W(a)||J(a),[qe]:a=>K(a)||W(a)||J(a)},ce=Symbol("radioGroupKey"),de=(a,n)=>{const o=y(),t=Ie(ce,void 0),s=P(()=>!!t),r=P({get(){return s.value?t.modelValue:a.modelValue},set(p){s.value?t.changeEvent(p):n&&n(G,p),o.value.checked=a.modelValue===a.label}}),l=Le(P(()=>t==null?void 0:t.size)),d=Oe(P(()=>t==null?void 0:t.disabled)),c=y(!1),i=P(()=>d.value||s.value&&r.value!==a.label?-1:0);return{radioRef:o,isGroup:s,radioGroup:t,focus:c,size:l,disabled:d,tabIndex:i,modelValue:r}},lo=["value","name","disabled"],to=S({name:"ElRadio"}),no=S({...to,props:oo,emits:ue,setup(a,{emit:n}){const o=a,t=q("radio"),{radioRef:s,radioGroup:r,focus:l,size:d,disabled:c,modelValue:i}=de(o,n);function p(){oe(()=>n("change",i.value))}return(u,m)=>{var E;return _(),g("label",{class:F([e(t).b(),e(t).is("disabled",e(c)),e(t).is("focus",e(l)),e(t).is("bordered",u.border),e(t).is("checked",e(i)===u.label),e(t).m(e(d))])},[f("span",{class:F([e(t).e("input"),e(t).is("disabled",e(c)),e(t).is("checked",e(i)===u.label)])},[Z(f("input",{ref_key:"radioRef",ref:s,"onUpdate:modelValue":m[0]||(m[0]=V=>X(i)?i.value=V:null),class:F(e(t).e("original")),value:u.label,name:u.name||((E=e(r))==null?void 0:E.name),disabled:e(c),type:"radio",onFocus:m[1]||(m[1]=V=>l.value=!0),onBlur:m[2]||(m[2]=V=>l.value=!1),onChange:p},null,42,lo),[[Q,e(i)]]),f("span",{class:F(e(t).e("inner"))},null,2)],2),f("span",{class:F(e(t).e("label")),onKeydown:m[3]||(m[3]=ee(()=>{},["stop"]))},[H(u.$slots,"default",{},()=>[A(x(u.label),1)])],34)],2)}}});var ao=D(no,[["__file","/home/runner/work/element-plus/element-plus/packages/components/radio/src/radio.vue"]]);const so=O({...ie,name:{type:String,default:""}}),ro=["value","name","disabled"],io=S({name:"ElRadioButton"}),uo=S({...io,props:so,setup(a){const n=a,o=q("radio"),{radioRef:t,focus:s,size:r,disabled:l,modelValue:d,radioGroup:c}=de(n),i=P(()=>({backgroundColor:(c==null?void 0:c.fill)||"",borderColor:(c==null?void 0:c.fill)||"",boxShadow:c!=null&&c.fill?`-1px 0 0 0 ${c.fill}`:"",color:(c==null?void 0:c.textColor)||""}));return(p,u)=>{var m;return _(),g("label",{class:F([e(o).b("button"),e(o).is("active",e(d)===p.label),e(o).is("disabled",e(l)),e(o).is("focus",e(s)),e(o).bm("button",e(r))])},[Z(f("input",{ref_key:"radioRef",ref:t,"onUpdate:modelValue":u[0]||(u[0]=E=>X(d)?d.value=E:null),class:F(e(o).be("button","original-radio")),value:p.label,type:"radio",name:p.name||((m=e(c))==null?void 0:m.name),disabled:e(l),onFocus:u[1]||(u[1]=E=>s.value=!0),onBlur:u[2]||(u[2]=E=>s.value=!1)},null,42,ro),[[Q,e(d)]]),f("span",{class:F(e(o).be("button","inner")),style:Pe(e(d)===p.label?e(i):{}),onKeydown:u[3]||(u[3]=ee(()=>{},["stop"]))},[H(p.$slots,"default",{},()=>[A(x(p.label),1)])],38)],2)}}});var me=D(uo,[["__file","/home/runner/work/element-plus/element-plus/packages/components/radio/src/radio-button.vue"]]);const co=O({id:{type:String,default:void 0},size:te,disabled:Boolean,modelValue:{type:[String,Number,Boolean],default:""},fill:{type:String,default:""},label:{type:String,default:void 0},textColor:{type:String,default:""},name:{type:String,default:void 0},validateEvent:{type:Boolean,default:!0}}),mo=ue,fo=["id","aria-label","aria-labelledby"],po=S({name:"ElRadioGroup"}),_o=S({...po,props:co,emits:mo,setup(a,{emit:n}){const o=a,t=q("radio"),s=$e(),r=y(),{formItem:l}=ze(),{inputId:d,isLabeledByFormItem:c}=Me(o,{formItemContext:l}),i=u=>{n(G,u),oe(()=>n("change",u))};le(()=>{const u=r.value.querySelectorAll("[type=radio]"),m=u[0];!Array.from(u).some(E=>E.checked)&&m&&(m.tabIndex=0)});const p=P(()=>o.name||s.value);return Be(ce,M({...Ce(o),changeEvent:i,name:p})),we(()=>o.modelValue,()=>{o.validateEvent&&(l==null||l.validate("change").catch(u=>Ge()))}),(u,m)=>(_(),g("div",{id:e(d),ref_key:"radioGroupRef",ref:r,class:F(e(t).b("group")),role:"radiogroup","aria-label":e(c)?void 0:u.label||"radio-group","aria-labelledby":e(c)?e(l).labelId:void 0},[H(u.$slots,"default")],10,fo))}});var fe=D(_o,[["__file","/home/runner/work/element-plus/element-plus/packages/components/radio/src/radio-group.vue"]]);const vo=He(ao,{RadioButton:me,RadioGroup:fe}),go=ae(fe);ae(me);const ho=async(a,n,o)=>{const t=j(),s=[],r=[],l=Qe(a.value,n.value,o);console.log(l);const d=await t.getAllProducts();for(let i of d){const p=Xe(i);c(p,l)&&(i.exception?r.push(i):s.push(i))}return{recomended:s,exceptions:r,fields:l};function c(i,p){if(i.fields&&i.fields.length>0)for(let u of i.fields){const m=p.find(E=>E.fieldId===u.id);if(!m)return!1;if(u.value&&m.fieldValue){const[E,V]=u.value.toString().split("<x<"),w=parseFloat(m.fieldValue);if(!(parseFloat(E)<=w)||!(w<=parseFloat(V)))return!1}}return!(i.orFields&&i.orFields.length>0&&!i.orFields.some(u=>p.some(m=>m.fieldId===u.id))||i.notFields&&i.notFields.length>0&&i.notFields.some(u=>p.some(m=>m.fieldId===u.id))||i.notOrFields&&i.notOrFields.length>0&&i.notOrFields.some(u=>p.some(m=>m.fieldId===u.id))||i.prioriteFields&&i.prioriteFields.length>0&&!i.prioriteFields.every(u=>p.some(m=>m.fieldId===u.id))||i.prioriteOrFields&&i.prioriteOrFields.length>0&&!i.prioriteOrFields.some(u=>p.some(m=>m.fieldId===u.id)))}},bo=Ue('<h1>Автохимия <br>для человека</h1><p>Теперь вы можете сами улучшить работу двигателя и узлов трансмиссии своего автомобиля: увеличить срок эксплуатации, повысить надежность и экономичность.<br>Для этого достаточно внимательно прочитать и заполнить необходимые поля и отметить характеристики в различных категориях.<br>В результате вам будет рекомендован один из продуктов компании «РУТЕК», который позволит улучшить работу двигателя, узлов трансмиссии указанного автомобиля.</p><p>Применять добавки RUTEC просто и быстро. В этом убедились десятки тысяч автовладельцев.<br> Это подтверждают отзывы на маркетплейсах (только на OZON отзывов около 4000).</p><p>Купить рекомендованный товар можно как на маркетппейсах, так и в интернет-магазине <a href="https://rutec-shop.ru/" target="_blank">rutec-shop.ru</a>.</p><p>Если вы хотите получить скидку в 15% на покупку в интернет-магазине производителя добавок RUTEC, то введите в поле ниже адрес вашей электронной почты, на который мы отправим купон на скидку. </p><p>Просто и быстро. И в любом месте. И не надо ездить по сервисам.</p>',6),yo={class:"promoBlock"},ko=f("h3",null,"Email для получения скидки:",-1),Eo=S({__name:"AnketaText",setup(a){const n=y(),o=M({email:"",accept:""}),t=M({email:[{required:!0,message:"Email обязателен",trigger:"blur"},{type:"email",message:"Укажите корректный email",trigger:["blur","change"]}],accept:[{required:!0,trigger:"change",message:"Необходимо ваше согласие"}]}),s=r=>{r&&r.validate(async l=>{if(l)await We({email:o.email})&&Je({message:"Отправили вам промокод на скидку"});else return console.log("error submit!"),!1})};return(r,l)=>{const d=Y,c=je,i=ne,p=se,u=Ke;return _(),g(I,null,[bo,f("div",yo,[ko,b(u,{ref_key:"ruleFormRef",ref:n,model:e(o),"status-icon":"",rules:e(t),class:"demo-ruleForm"},{default:k(()=>[b(c,{prop:"email"},{default:k(()=>[b(d,{modelValue:e(o).email,"onUpdate:modelValue":l[0]||(l[0]=m=>e(o).email=m),placeholder:"mail@mail.ru"},null,8,["modelValue"])]),_:1}),b(c,null,{default:k(()=>[b(i,{onClick:l[1]||(l[1]=m=>s(e(n))),type:"success",size:"large",class:"getPromoBtn",disabled:!e(o).email&&!e(o).accept},{default:k(()=>[A(" ХОЧУ СКИДКУ! ")]),_:1},8,["disabled"])]),_:1}),b(c,{prop:"accept",class:"acceptCheckbox"},{default:k(()=>[b(p,{modelValue:e(o).accept,"onUpdate:modelValue":l[2]||(l[2]=m=>e(o).accept=m),label:"Согласие на обработку персональных данных",name:"accept"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])])],64)}}});const Fo={key:0,class:"promoFact"},Vo={class:"card-header"},Ro=f("span",null,"Факты о РУТЕК",-1),xo=["innerHTML"],So={key:1,class:"promoVideo"},Io={class:"card-header"},Po=["href"],$o=["href"],Bo=["src","alt"],Co=S({__name:"PromoMaterial",setup(a){const n=y(null),o=y(null);return Te(async()=>{const t=Ze();await t.getRandomPromo(),n.value=t.randomPromo.fact,o.value=t.randomPromo.video}),(t,s)=>{const r=re;return _(),g(I,null,[e(n)?(_(),g("div",Fo,[b(r,{class:"box-card"},{header:k(()=>[f("div",Vo,[Ro,f("span",null,[f("h4",null,x(e(n).name),1)])])]),default:k(()=>[f("div",null,[f("p",{innerHTML:e(n).text},null,8,xo)])]),_:1})])):$("",!0),e(o)?(_(),g("div",So,[b(r,{class:"box-card"},{header:k(()=>[f("div",Io,[f("span",null,[f("h4",null,x(e(o).name),1)])])]),default:k(()=>{var l;return[f("div",null,[f("a",{href:e(o).videoUrl,target:"_blank"},x(e(o).videoUrl),9,Po),f("a",{href:e(o).videoUrl,target:"_blank"},[f("img",{src:"/video/"+e(o).videoPreview,alt:(l=e(o))==null?void 0:l.name},null,8,Bo)],8,$o)])]}),_:1})])):$("",!0)],64)}}});const wo={key:0,class:"adminsRec"},Uo=f("div",{class:"card-header"},[f("span",null,"Рекомендация")],-1),To=S({__name:"AdminRecomendation",props:{recomendation:{type:Object}},async setup(a){let n,o;const t=a,s=j(),r=y(!1),l=([n,o]=L(()=>s.validateUser()),n=await n,o(),n);return t.recomendation&&(r.value=!0),console.log(t.recomendation),(d,c)=>{const i=re;return a.recomendation&&e(l)?(_(),g("div",wo,[b(i,{class:"box-card"},{header:k(()=>[Uo]),default:k(()=>[(_(!0),g(I,null,T(a.recomendation,p=>(_(),g("div",null,[f("div",null,x(p.name),1)]))),256))]),_:1})])):$("",!0)}}});function Ao(a,n,o){var d;const s=o.find(c=>c.function==="cleaner").id;if(!s){console.log('Кнопка очистки неполадок не найдена "Работа двигателя не сопровождается никаким из ниже перечисленных признаков"');return}const r=[];for(let c of o)c.trouble&&r.push(c.id);if(a.value[s])if(((d=a.value[s])==null?void 0:d.length)===1){l();for(let c of r)a.value[c]=void 0;n.value=!0}else l(),a.value.splice(s,1),n.value=!0;function l(){const c=document.querySelectorAll(".trouble");for(let i of c)i.classList.contains("disable")?i.classList.remove("disable"):i.classList.add("disable")}}function No(a,n,o){const t=[];for(let r of o)r.part==="unit"&&t.push(r.id);if(t.length===0)return;const s=[];a.value.forEach((r,l)=>{t.includes(l)&&r!==void 0&&s.push(r)}),a.value.forEach((r,l)=>{t.includes(l)&&s.length>1&&l!==n&&(a.value[l]=void 0)})}function Lo(a,n,o){const t=[];let s=null;for(let l of o)l.function!=="cleaner"&&l.trouble&&t.push(l.id),l.function=="cleaner"&&(s=l.id);if(t.length===0)return;let r=!1;a.value.forEach((l,d)=>{t.includes(d)&&l&&(l==null?void 0:l.length)>0&&(r=!1)}),r?(n.value=!0,a.value[s]=void 0):n.value=!1}function Oo(a){const[n,o,t,s,r,l,d]=a;n.length===0&&pe(d,l),!qo(t,s,r)&&(zo(n,t,d,l),Mo(o,t,d,l),Ho(t,r),console.log("Отфильтрованный товар:",d.value),d.value?s.value=!0:s.value=!1)}function zo(a,n,o,t){if(a.length===1&&(o.value=a[0],t.value=a[0].url),a.length>1){console.log("КОНФЛИКТ ТОВАРОВ!"),console.log(...a);const s=[];for(let r of a)console.log("Проверяем у которого из товаров есть приоритетные поля"),(r.prioriteFields||r.prioriteOrFields)&&s.push(r);s.length==0&&console.log("Приоритетных товаров не найдено. Невозможно разрешить конфликт"),s.length>1&&(console.log("В рекомендациях оказалось более одного товара с приоритетными полями"),console.log(...s)),s.length===1&&(console.log("Товар с приоритетными отфильтрован"),o.value=s[0],t.value=s[0].url)}}function Mo(a,n,o,t){console.log("exceptions",...a);for(let l of n)if(l.fieldId===49)return;if(a.length>=1){const l=[];for(let d of n)d.trouble&&l.push(d);if(console.log("Отмечено признаков неисправностей:",l.length),l.length>1&&(console.log("selectedBadSigns.length",l.length),s()),l.length===1){let d=!0;for(let c of l)c.special&&(d=!1);d?s():r()}}else r();function s(){o.value=a[0],t.value=a[0].url}function r(){o.value&&o.value.exception&&pe(o,t)}}function qo(a,n,o){const t=a.find(s=>s.blockRecomendation===!0);return t?(n.value=!1,o.value=!0):o.value=!1,t}function Ho(a,n){for(let o of a)if(o.alert){n.value=!0;return}if(a.length===1&&a[0].alert){n.value=!0;return}n.value=!1}function pe(a,n){a.value=void 0,n.value=void 0}function Go(a,n,o){var t;a.value&&(n.value?(window.open(n.value,"_blank"),(t=o.value)!=null&&t.recText&&eo({showClose:!0,dangerouslyUseHTMLString:!0,message:o.value.recText,type:"success",duration:0})):Ye({title:"Ошибка",message:"Указанных параметров не достаточно для рекомендации"}))}const Do={class:"anketa_wrapper"},jo={class:"anketa"},Ko={class:"inputGroup"},Wo={key:0},Jo={class:"anketaText"},Yo=f("b",null,"Очистить выбранное",-1),Pl={__name:"index",async setup(a){let n,o;const t=j();let s=[];try{s=([n,o]=L(()=>t.getAllSignGroup()),n=await n,o(),n)}catch(R){console.log(R)}if(s.length===0)try{const R=([n,o]=L(()=>fetch("/api/signs/all")),n=await n,o(),n);s=([n,o]=L(()=>R.json()),n=await n,o(),n)}catch(R){console.log(R)}console.log(s);const r=y([]),l=y([]),d=y(!1),c=y(!1),i=y(!0),p=y(""),u=y(null),m=y(null),E=y(null);async function V(R){console.log(`---
`),Ao(r,i,s),Lo(r,i,s),No(r,R,s);const{recomended:U,exceptions:z,fields:N}=await ho(l,r,s);Oo([U,z,N,d,c,u,m]),E.value=U,w()}function w(){i.value?document.querySelector(p.value).classList.add("disable"):document.querySelector(p.value).classList.remove("disable")}function _e(){r.value=[],d.value=!1,c.value=!1,i.value=!0,w()}function ve(){Go(d,u,m)}return le(()=>{const R=s.find(U=>U.function==="block");p.value=`.groupId_${R.id}`,document.querySelector(p.value).classList.add("disable")}),(R,U)=>{const z=Se,N=Y,ge=vo,he=go,be=se,ye=De,ke=Eo,Ee=Co,Fe=To,Ve=Ne,Re=ne;return _(),g(I,null,[b(z),f("main",Do,[f("div",jo,[(_(!0),g(I,null,T(e(s),(h,xe)=>(_(),g("div",{key:xe,class:F(["optionsGroup",{inputs:h.fieldsType==="input",trouble:h.trouble},"groupId_"+h.id])},[f("h3",null,x(h.name),1),h.fieldsType=="input"?(_(!0),g(I,{key:0},T(h.signs,v=>(_(),g("div",Ko,[A(x(v.name)+" ",1),v.required?(_(),g("sup",Wo," * ")):$("",!0),v.type=="number"?(_(),C(N,{modelValue:e(l)[v.id],"onUpdate:modelValue":B=>e(l)[v.id]=B,placeholder:v.placeholder,key:v.id,formatter:B=>B.replace(/[^0-9\,]/g,""),onChange:V},null,8,["modelValue","onUpdate:modelValue","placeholder","formatter"])):(_(),C(N,{modelValue:e(l)[v.id],"onUpdate:modelValue":B=>e(l)[v.id]=B,placeholder:v.placeholder,key:v.id,onChange:V},null,8,["modelValue","onUpdate:modelValue","placeholder"]))]))),256)):$("",!0),h.fieldsType=="radio"?(_(),C(he,{key:1,modelValue:e(r)[h.id],"onUpdate:modelValue":v=>e(r)[h.id]=v},{default:k(()=>[(_(!0),g(I,null,T(h.signs,v=>(_(),C(ge,{label:v.name,key:h.id,onChange:B=>V(h.id)},{default:k(()=>[A(x(v.name),1)]),_:2},1032,["label","onChange"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):$("",!0),h.fieldsType=="checkbox"?(_(),C(ye,{key:2,modelValue:e(r)[h.id],"onUpdate:modelValue":v=>e(r)[h.id]=v},{default:k(()=>[(_(!0),g(I,null,T(h.signs,v=>(_(),C(be,{label:v.name,key:h.id,onChange:V},null,8,["label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):$("",!0)],2))),128))]),f("div",Jo,[b(ke),b(Ee),b(Fe,{recomendation:e(E)},null,8,["recomendation"])]),f("div",{class:F(["recomendationBtnDanger",{active:e(c)}])}," Рекомендация позвонить по номеру 8 800 101 90 07 для консультации. ",2),f("div",{class:F(["recomendationBtn",{active:e(d)}]),onClick:ve}," РЕКОМЕНДАЦИИ ",2),f("div",{class:F(["clear_selections",{recActive:e(d),noSelectors:e(r).length===0}])},[b(Re,{class:"deleteProductBtn",size:"large",type:"primary",onClick:_e},{default:k(()=>[Yo,b(Ve,null,{default:k(()=>[b(e(Ae))]),_:1})]),_:1})],2)])],64)}}};export{Pl as default};
