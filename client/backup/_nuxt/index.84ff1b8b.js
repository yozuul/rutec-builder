import{_ as Pe}from"./PublicNavi.vue.ec6ca0ef.js";import{E as $e,a as Be}from"./el-select.afc64d75.js";import{E as M}from"./el-card.0e945044.js";import{_ as q,w as Ie,b as ee}from"./base.9e48fd82.js";import{E as oe}from"./el-input.f8c21414.js";import"./el-scrollbar.59c927cb.js";import"./el-popper.7a72c05b.js";import{u as we}from"./partnerStore.30d8f4b1.js";import{C as Q,r as k,L as Ue,a as B,p as x,A as D,o as _,k as g,h as p,a4 as te,ak as le,u as e,i as H,D as S,G as K,j as T,t as F,J as ne,Y as ae,E as Te,a1 as Ae,b as se,R as Ne,v as z,a2 as Le,w as Oe,s as j,f as y,e as E,F as V,l as I,c as $,m as R,al as ze,ab as Me}from"./entry.217baba9.js";import{b as L,n as X,q as G,I as qe,E as De}from"./index.3749c23d.js";import{v as re,d as He,a as Ke,b as je,f as We,E as ie}from"./el-button.66a7494d.js";import{U as W,C as Je}from"./event.9519ab40.js";import{d as Ye}from"./aria.e6ae6494.js";import{E as ue,a as Ze}from"./el-checkbox.86d566aa.js";import{E as Qe,a as Xe}from"./el-form.c49b197b.js";import{s as Ge}from"./fetch-data.87f96ffe.js";import{a as eo,n as oo}from"./notify.216590b0.js";import{u as to}from"./promoStore.9db73eff.js";import{u as J}from"./fetch.381ee2a2.js";/* empty css                          *//* empty css                */import{g as lo}from"./field-id-sorter.b437f58c.js";import{c as no}from"./convert-products-fields.6a8f9e75.js";import{E as ao}from"./el-message.62003579.js";import"./el-menu.a65f5324.js";import"./vnode.3d052031.js";import"./typescript.defaf979.js";import"./el-tooltip.4ed993c7.js";import"./validator.793f5923.js";import"./_Uint8Array.5bb04ca3.js";import"./api.config.7d19f9a3.js";import"./cookie.5c62db49.js";import"./_initCloneObject.8fc5fac6.js";import"./el-notification.e5d2fd0a.js";const ce=L({size:re,disabled:Boolean,label:{type:[String,Number,Boolean],default:""}}),so=L({...ce,modelValue:{type:[String,Number,Boolean],default:""},name:{type:String,default:""},border:Boolean}),de={[W]:n=>Q(n)||X(n)||G(n),[Je]:n=>Q(n)||X(n)||G(n)},me=Symbol("radioGroupKey"),pe=(n,a)=>{const l=k(),t=Ue(me,void 0),s=B(()=>!!t),r=B({get(){return s.value?t.modelValue:n.modelValue},set(f){s.value?t.changeEvent(f):a&&a(W,f),l.value.checked=n.modelValue===n.label}}),o=He(B(()=>t==null?void 0:t.size)),d=Ke(B(()=>t==null?void 0:t.disabled)),c=k(!1),i=B(()=>d.value||s.value&&r.value!==n.label?-1:0);return{radioRef:l,isGroup:s,radioGroup:t,focus:c,size:o,disabled:d,tabIndex:i,modelValue:r}},ro=["value","name","disabled"],io=x({name:"ElRadio"}),uo=x({...io,props:so,emits:de,setup(n,{emit:a}){const l=n,t=D("radio"),{radioRef:s,radioGroup:r,focus:o,size:d,disabled:c,modelValue:i}=pe(l,a);function f(){ae(()=>a("change",i.value))}return(u,m)=>{var v;return _(),g("label",{class:S([e(t).b(),e(t).is("disabled",e(c)),e(t).is("focus",e(o)),e(t).is("bordered",u.border),e(t).is("checked",e(i)===u.label),e(t).m(e(d))])},[p("span",{class:S([e(t).e("input"),e(t).is("disabled",e(c)),e(t).is("checked",e(i)===u.label)])},[te(p("input",{ref_key:"radioRef",ref:s,"onUpdate:modelValue":m[0]||(m[0]=C=>H(i)?i.value=C:null),class:S(e(t).e("original")),value:u.label,name:u.name||((v=e(r))==null?void 0:v.name),disabled:e(c),type:"radio",onFocus:m[1]||(m[1]=C=>o.value=!0),onBlur:m[2]||(m[2]=C=>o.value=!1),onChange:f},null,42,ro),[[le,e(i)]]),p("span",{class:S(e(t).e("inner"))},null,2)],2),p("span",{class:S(e(t).e("label")),onKeydown:m[3]||(m[3]=ne(()=>{},["stop"]))},[K(u.$slots,"default",{},()=>[T(F(u.label),1)])],34)],2)}}});var co=q(uo,[["__file","/home/runner/work/element-plus/element-plus/packages/components/radio/src/radio.vue"]]);const mo=L({...ce,name:{type:String,default:""}}),po=["value","name","disabled"],fo=x({name:"ElRadioButton"}),_o=x({...fo,props:mo,setup(n){const a=n,l=D("radio"),{radioRef:t,focus:s,size:r,disabled:o,modelValue:d,radioGroup:c}=pe(a),i=B(()=>({backgroundColor:(c==null?void 0:c.fill)||"",borderColor:(c==null?void 0:c.fill)||"",boxShadow:c!=null&&c.fill?`-1px 0 0 0 ${c.fill}`:"",color:(c==null?void 0:c.textColor)||""}));return(f,u)=>{var m;return _(),g("label",{class:S([e(l).b("button"),e(l).is("active",e(d)===f.label),e(l).is("disabled",e(o)),e(l).is("focus",e(s)),e(l).bm("button",e(r))])},[te(p("input",{ref_key:"radioRef",ref:t,"onUpdate:modelValue":u[0]||(u[0]=v=>H(d)?d.value=v:null),class:S(e(l).be("button","original-radio")),value:f.label,type:"radio",name:f.name||((m=e(c))==null?void 0:m.name),disabled:e(o),onFocus:u[1]||(u[1]=v=>s.value=!0),onBlur:u[2]||(u[2]=v=>s.value=!1)},null,42,po),[[le,e(d)]]),p("span",{class:S(e(l).be("button","inner")),style:Te(e(d)===f.label?e(i):{}),onKeydown:u[3]||(u[3]=ne(()=>{},["stop"]))},[K(f.$slots,"default",{},()=>[T(F(f.label),1)])],38)],2)}}});var fe=q(_o,[["__file","/home/runner/work/element-plus/element-plus/packages/components/radio/src/radio-button.vue"]]);const vo=L({id:{type:String,default:void 0},size:re,disabled:Boolean,modelValue:{type:[String,Number,Boolean],default:""},fill:{type:String,default:""},label:{type:String,default:void 0},textColor:{type:String,default:""},name:{type:String,default:void 0},validateEvent:{type:Boolean,default:!0}}),go=de,ho=["id","aria-label","aria-labelledby"],bo=x({name:"ElRadioGroup"}),yo=x({...bo,props:vo,emits:go,setup(n,{emit:a}){const l=n,t=D("radio"),s=Ae(),r=k(),{formItem:o}=je(),{inputId:d,isLabeledByFormItem:c}=We(l,{formItemContext:o}),i=u=>{a(W,u),ae(()=>a("change",u))};se(()=>{const u=r.value.querySelectorAll("[type=radio]"),m=u[0];!Array.from(u).some(v=>v.checked)&&m&&(m.tabIndex=0)});const f=B(()=>l.name||s.value);return Ne(me,z({...Le(l),changeEvent:i,name:f})),Oe(()=>l.modelValue,()=>{l.validateEvent&&(o==null||o.validate("change").catch(u=>Ye()))}),(u,m)=>(_(),g("div",{id:e(d),ref_key:"radioGroupRef",ref:r,class:S(e(t).b("group")),role:"radiogroup","aria-label":e(c)?void 0:u.label||"radio-group","aria-labelledby":e(c)?e(o).labelId:void 0},[K(u.$slots,"default")],10,ho))}});var _e=q(yo,[["__file","/home/runner/work/element-plus/element-plus/packages/components/radio/src/radio-group.vue"]]);const ko=Ie(co,{RadioButton:fe,RadioGroup:_e}),Eo=ee(_e);ee(fe);const So=async(n,a,l)=>{const t=J(),s=[],r=[],o=lo(n.value,a.value,l);console.log(o);const d=await t.getAllProducts();for(let i of d){const f=no(i);c(f,o)&&(i.exception?r.push(i):s.push(i))}return{recomended:s,exceptions:r,fields:o};function c(i,f){if(i.fields&&i.fields.length>0)for(let u of i.fields){const m=f.find(v=>v.fieldId===u.id);if(!m)return!1;if(u.value&&m.fieldValue){const[v,C]=u.value.toString().split("<x<"),P=parseFloat(m.fieldValue);if(!(parseFloat(v)<=P)||!(P<=parseFloat(C)))return!1}}return!(i.orFields&&i.orFields.length>0&&!i.orFields.some(u=>f.some(m=>m.fieldId===u.id))||i.notFields&&i.notFields.length>0&&i.notFields.some(u=>f.some(m=>m.fieldId===u.id))||i.notOrFields&&i.notOrFields.length>0&&i.notOrFields.some(u=>f.some(m=>m.fieldId===u.id))||i.prioriteFields&&i.prioriteFields.length>0&&!i.prioriteFields.every(u=>f.some(m=>m.fieldId===u.id))||i.prioriteOrFields&&i.prioriteOrFields.length>0&&!i.prioriteOrFields.some(u=>f.some(m=>m.fieldId===u.id)))}},Fo={class:"citySelector"},Vo={key:0,class:"partnerRec"},xo={key:0},Ro=x({__name:"SelectCity",async setup(n){let a,l;const t=we();try{[a,l]=j(()=>t.getCityForUser()),await a,l()}catch(c){console.log(c)}const s=k(""),r=t.usersCity,o=k(r);async function d(){await t.findByCity(s.value),console.log("partnerStore.usersCity",t.usersPartners)}return(c,i)=>{const f=$e,u=Be,m=M;return _(),g("div",Fo,[y(u,{modelValue:e(s),"onUpdate:modelValue":i[0]||(i[0]=v=>H(s)?s.value=v:null),filterable:"",placeholder:"Выбор города",onChange:d},{default:E(()=>[(_(!0),g(V,null,I(e(o),v=>(_(),$(f,{key:v.id,label:v.name,value:v.name},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),e(t).usersPartners.length>0?(_(),g("div",Vo,[y(m,{class:"box-card"},{default:E(()=>[(_(!0),g(V,null,I(e(t).usersPartners,v=>(_(),g("div",null,[p("div",null,[p("b",null,F(v.companyName),1)]),p("div",null,[T(F(v.adress)+" ",1),v.phone?(_(),g("span",xo,". Тел.: "+F(v.phone),1)):R("",!0)])]))),256))]),_:1})])):R("",!0)])}}});const Co=ze('<h1>Автохимия <br>для человека</h1><p>Теперь вы можете сами улучшить работу двигателя и узлов трансмиссии своего автомобиля: увеличить срок эксплуатации, повысить надежность и экономичность.<br>Для этого достаточно внимательно прочитать и заполнить необходимые поля и отметить характеристики в различных категориях.<br>В результате вам будет рекомендован один из продуктов компании «РУТЕК», который позволит улучшить работу двигателя, узлов трансмиссии указанного автомобиля.</p><p>Применять добавки RUTEC просто и быстро. В этом убедились десятки тысяч автовладельцев.<br> Это подтверждают отзывы на маркетплейсах (только на OZON отзывов около 4000).</p><p>Купить рекомендованный товар можно как на маркетппейсах, так и в интернет-магазине <a href="https://rutec-shop.ru/" target="_blank">rutec-shop.ru</a>.</p><p>Если вы хотите получить скидку в 15% на покупку в интернет-магазине производителя добавок RUTEC, то введите в поле ниже адрес вашей электронной почты, на который мы отправим купон на скидку. </p><p>Просто и быстро. И в любом месте. И не надо ездить по сервисам.</p>',6),Po={class:"promoBlock"},$o=p("h3",null,"Email для получения скидки:",-1),Bo=x({__name:"AnketaText",setup(n){const a=k(),l=z({email:"",accept:""}),t=z({email:[{required:!0,message:"Email обязателен",trigger:"blur"},{type:"email",message:"Укажите корректный email",trigger:["blur","change"]}],accept:[{required:!0,trigger:"change",message:"Необходимо ваше согласие"}]}),s=r=>{r&&r.validate(async o=>{if(o)await Ge({email:l.email})&&eo({message:"Отправили вам промокод на скидку"});else return console.log("error submit!"),!1})};return(r,o)=>{const d=oe,c=Qe,i=ie,f=ue,u=Xe;return _(),g(V,null,[Co,p("div",Po,[$o,y(u,{ref_key:"ruleFormRef",ref:a,model:e(l),"status-icon":"",rules:e(t),class:"demo-ruleForm"},{default:E(()=>[y(c,{prop:"email"},{default:E(()=>[y(d,{modelValue:e(l).email,"onUpdate:modelValue":o[0]||(o[0]=m=>e(l).email=m),placeholder:"mail@mail.ru"},null,8,["modelValue"])]),_:1}),y(c,null,{default:E(()=>[y(i,{onClick:o[1]||(o[1]=m=>s(e(a))),type:"success",size:"large",class:"getPromoBtn",disabled:!e(l).email&&!e(l).accept},{default:E(()=>[T(" ХОЧУ СКИДКУ! ")]),_:1},8,["disabled"])]),_:1}),y(c,{prop:"accept",class:"acceptCheckbox"},{default:E(()=>[y(f,{modelValue:e(l).accept,"onUpdate:modelValue":o[2]||(o[2]=m=>e(l).accept=m),label:"Согласие на обработку персональных данных",name:"accept"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])])],64)}}});const Io={key:0,class:"promoFact"},wo={class:"card-header"},Uo=p("span",null,"Факты о РУТЕК",-1),To=["innerHTML"],Ao={key:1,class:"promoVideo"},No={class:"card-header"},Lo=["href"],Oo=["href"],zo=["src","alt"],Mo=x({__name:"PromoMaterial",setup(n){const a=k(null),l=k(null);return Me(async()=>{const t=to();await t.getRandomPromo(),a.value=t.randomPromo.fact,l.value=t.randomPromo.video}),(t,s)=>{const r=M;return _(),g(V,null,[e(a)?(_(),g("div",Io,[y(r,{class:"box-card"},{header:E(()=>[p("div",wo,[Uo,p("span",null,[p("h4",null,F(e(a).name),1)])])]),default:E(()=>[p("div",null,[p("p",{innerHTML:e(a).text},null,8,To)])]),_:1})])):R("",!0),e(l)?(_(),g("div",Ao,[y(r,{class:"box-card"},{header:E(()=>[p("div",No,[p("span",null,[p("h4",null,F(e(l).name),1)])])]),default:E(()=>{var o;return[p("div",null,[p("a",{href:e(l).videoUrl,target:"_blank"},F(e(l).videoUrl),9,Lo),p("a",{href:e(l).videoUrl,target:"_blank"},[p("img",{src:"/video/"+e(l).videoPreview,alt:(o=e(l))==null?void 0:o.name},null,8,zo)],8,Oo)])]}),_:1})])):R("",!0)],64)}}});const qo={key:0,class:"adminsRec"},Do=p("div",{class:"card-header"},[p("span",null,"Рекомендация")],-1),Ho=x({__name:"AdminRecomendation",props:{recomendation:{type:Object}},async setup(n){let a,l;const t=n,s=J(),r=k(!1),o=([a,l]=j(()=>s.validateUser()),a=await a,l(),a);return t.recomendation&&(r.value=!0),console.log(t.recomendation),(d,c)=>{const i=M;return n.recomendation&&e(o)?(_(),g("div",qo,[y(i,{class:"box-card"},{header:E(()=>[Do]),default:E(()=>[(_(!0),g(V,null,I(n.recomendation,f=>(_(),g("div",null,[p("div",null,F(f.name),1)]))),256))]),_:1})])):R("",!0)}}});function Ko(n,a,l){var d;const s=l.find(c=>c.function==="cleaner").id;if(!s){console.log('Кнопка очистки неполадок не найдена "Работа двигателя не сопровождается никаким из ниже перечисленных признаков"');return}const r=[];for(let c of l)c.trouble&&r.push(c.id);if(n.value[s])if(((d=n.value[s])==null?void 0:d.length)===1){o();for(let c of r)n.value[c]=void 0;a.value=!0}else o(),n.value.splice(s,1),a.value=!0;function o(){const c=document.querySelectorAll(".trouble");for(let i of c)i.classList.contains("disable")?i.classList.remove("disable"):i.classList.add("disable")}}function jo(n,a,l){const t=[];for(let r of l)r.part==="unit"&&t.push(r.id);if(t.length===0)return;const s=[];n.value.forEach((r,o)=>{t.includes(o)&&r!==void 0&&s.push(r)}),n.value.forEach((r,o)=>{t.includes(o)&&s.length>1&&o!==a&&(n.value[o]=void 0)})}function Wo(n,a,l){const t=[];let s=null;for(let o of l)o.function!=="cleaner"&&o.trouble&&t.push(o.id),o.function=="cleaner"&&(s=o.id);if(t.length===0)return;let r=!1;n.value.forEach((o,d)=>{t.includes(d)&&o&&(o==null?void 0:o.length)>0&&(r=!1)}),r?(a.value=!0,n.value[s]=void 0):a.value=!1}function Jo(n){const[a,l,t,s,r,o,d]=n;a.length===0&&ve(d,o),!Qo(t,s,r)&&(Yo(a,t,d,o),Zo(l,t,d,o),Xo(t,r),console.log("Отфильтрованный товар:",d.value),d.value?s.value=!0:s.value=!1)}function Yo(n,a,l,t){if(n.length===1&&(l.value=n[0],t.value=n[0].url),n.length>1){console.log("КОНФЛИКТ ТОВАРОВ!"),console.log(...n);const s=[];for(let r of n)console.log("Проверяем у которого из товаров есть приоритетные поля"),(r.prioriteFields||r.prioriteOrFields)&&s.push(r);s.length==0&&console.log("Приоритетных товаров не найдено. Невозможно разрешить конфликт"),s.length>1&&(console.log("В рекомендациях оказалось более одного товара с приоритетными полями"),console.log(...s)),s.length===1&&(console.log("Товар с приоритетными отфильтрован"),l.value=s[0],t.value=s[0].url)}}function Zo(n,a,l,t){console.log("exceptions",...n);for(let o of a)if(o.fieldId===49)return;if(n.length>=1){const o=[];for(let d of a)d.trouble&&o.push(d);if(console.log("Отмечено признаков неисправностей:",o.length),o.length>1&&(console.log("selectedBadSigns.length",o.length),s()),o.length===1){let d=!0;for(let c of o)c.special&&(d=!1);d?s():r()}}else r();function s(){l.value=n[0],t.value=n[0].url}function r(){l.value&&l.value.exception&&ve(l,t)}}function Qo(n,a,l){const t=n.find(s=>s.blockRecomendation===!0);return t?(a.value=!1,l.value=!0):l.value=!1,t}function Xo(n,a){for(let l of n)if(l.alert){a.value=!0;return}if(n.length===1&&n[0].alert){a.value=!0;return}a.value=!1}function ve(n,a){n.value=void 0,a.value=void 0}function Go(n,a,l){var t;n.value&&(a.value?(window.open(a.value,"_blank"),(t=l.value)!=null&&t.recText&&ao({showClose:!0,dangerouslyUseHTMLString:!0,message:l.value.recText,type:"success",duration:0})):oo({title:"Ошибка",message:"Указанных параметров не достаточно для рекомендации"}))}const et={class:"anketa_wrapper"},ot={class:"anketa"},tt={class:"inputGroup"},lt={key:0},nt={class:"anketaText"},at=p("b",null,"Очистить выбранное",-1),zt={__name:"index",async setup(n){let a,l;const t=J();let s=([a,l]=j(()=>t.getAllSignGroup()),a=await a,l(),a),r=k(s);const o=k([]),d=k([]),c=k(!1),i=k(!1),f=k(!0),u=k(""),m=k(null),v=k(null),C=k(null);async function P(N){console.log(`---
`),Ko(o,f,r),Wo(o,f,r),jo(o,N,r);const{recomended:w,exceptions:A,fields:O}=await So(d,o,r);Jo([w,A,O,c,i,m,v]),C.value=w,Y()}function Y(){f.value?document.querySelector(u.value).classList.add("disable"):document.querySelector(u.value).classList.remove("disable")}function ge(){o.value=[],c.value=!1,i.value=!1,f.value=!0,Y()}function he(){Go(c,m,v)}return se(()=>{const N=r.value.find(A=>A.function==="block");u.value=`.groupId_${N.id}`;const w=document.querySelector(u.value);w&&w.classList.add("disable")}),(N,w)=>{const A=Pe,O=Ro,Z=oe,be=ko,ye=Eo,ke=ue,Ee=Ze,Se=Bo,Fe=Mo,Ve=Ho,xe=De,Re=ie;return _(),g(V,null,[y(A),p("main",et,[p("div",ot,[y(O),(_(!0),g(V,null,I(e(r),(h,Ce)=>(_(),g("div",{key:Ce,class:S(["optionsGroup",{inputs:(h==null?void 0:h.fieldsType)==="input",trouble:h==null?void 0:h.trouble},"groupId_"+h.id])},[p("h3",null,F(h.name),1),h.fieldsType=="input"?(_(!0),g(V,{key:0},I(h.signs,b=>(_(),g("div",tt,[T(F(b.name)+" ",1),b.required?(_(),g("sup",lt," * ")):R("",!0),b.type=="number"?(_(),$(Z,{modelValue:e(d)[b.id],"onUpdate:modelValue":U=>e(d)[b.id]=U,placeholder:b.placeholder,key:b.id,formatter:U=>U.replace(/[^0-9\,]/g,""),onChange:P},null,8,["modelValue","onUpdate:modelValue","placeholder","formatter"])):(_(),$(Z,{modelValue:e(d)[b.id],"onUpdate:modelValue":U=>e(d)[b.id]=U,placeholder:b.placeholder,key:b.id,onChange:P},null,8,["modelValue","onUpdate:modelValue","placeholder"]))]))),256)):R("",!0),h.fieldsType=="radio"?(_(),$(ye,{key:1,modelValue:e(o)[h.id],"onUpdate:modelValue":b=>e(o)[h.id]=b},{default:E(()=>[(_(!0),g(V,null,I(h.signs,b=>(_(),$(be,{label:b.name,key:h.id,onChange:U=>P(h.id)},{default:E(()=>[T(F(b.name),1)]),_:2},1032,["label","onChange"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):R("",!0),h.fieldsType=="checkbox"?(_(),$(Ee,{key:2,modelValue:e(o)[h.id],"onUpdate:modelValue":b=>e(o)[h.id]=b},{default:E(()=>[(_(!0),g(V,null,I(h.signs,b=>(_(),$(ke,{label:b.name,key:h.id,onChange:P},null,8,["label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):R("",!0)],2))),128))]),p("div",nt,[y(Se),y(Fe),y(Ve,{recomendation:e(C)},null,8,["recomendation"])]),p("div",{class:S(["recomendationBtnDanger",{active:e(i)}])}," Рекомендация позвонить по номеру 8 800 101 90 07 для консультации. ",2),p("div",{class:S(["recomendationBtn",{active:e(c)}]),onClick:he}," РЕКОМЕНДАЦИИ ",2),p("div",{class:S(["clear_selections",{recActive:e(c),noSelectors:e(o).length===0}])},[y(Re,{class:"deleteProductBtn",size:"large",type:"primary",onClick:ge},{default:E(()=>[at,y(xe,null,{default:E(()=>[y(e(qe))]),_:1})]),_:1})],2)])],64)}}};export{zt as default};
