import{E as T,a as S}from"./el-table.f8529865.js";import{E as N}from"./el-button.4b28c0d2.js";import{e as R,d as $,E as A}from"./index.4edc3df1.js";import{_ as D}from"./nuxt-link.856c34ed.js";import{E as F}from"./el-pagination.6c7486ac.js";import{a as M,_ as V}from"./layout.44602910.js";import"./base.2bb6cb54.js";import"./el-checkbox.2154bfa8.js";import"./el-scrollbar.1c121719.js";/* empty css                */import"./el-tooltip.4ed993c7.js";import"./el-popper.8acabd0f.js";import"./el-input.af81951a.js";import"./el-select.99d9b097.js";import{E as j}from"./el-overlay.90f58aaa.js";import{E as h}from"./el-message.6dbc9361.js";import{u as I}from"./promoStore.d434ca63.js";import{p as K,s as L,r as m,z as O,o as q,c as G,e as t,f as e,u as i,j as H}from"./entry.18e2495c.js";import"./aria.e146d83a.js";import"./_Uint8Array.bec00609.js";import"./_initCloneObject.e22dfabd.js";import"./isEqual.da90e6c9.js";import"./typescript.defaf979.js";import"./el-card.c774d930.js";import"./event.9519ab40.js";import"./validator.fc99fe8a.js";import"./vnode.21d4e520.js";import"./api.config.665f63bb.js";import"./cookie.3290b875.js";const we=K({__name:"index",async setup(J){let _,f;const c=I();[_,f]=L(()=>c.fetchAllPromo()),await _,f();let s=c.allPromo;const d=m(),y=()=>{d.value.clearFilter()},x=(o,n)=>n.type===o,a=m(50),l=m(1);let r=m([]);O(()=>{r.value=s.slice((l.value-1)*a.value,l.value*a.value)});const C=o=>{a.value=o,r.value=s.slice((l.value-1)*a.value,l.value*a.value)},E=o=>{l.value=o,r.value=s.slice((l.value-1)*a.value,l.value*a.value)},b=async o=>{try{await j.confirm("Уверены, что хотите удалить материал?","Внимание!",{cancelButtonText:"Отмена",confirmButtonText:"OK",type:"warning"});try{await c.deletePromo(o),r.value=r.value.filter(n=>n.id!==o),h({type:"success",message:"Материал удалён"})}catch{h({type:"error",message:"При удалении материала возникла ошибка"})}}catch{console.log("Удаление отменено")}};return(o,n)=>{const u=T,p=N,g=A,w=D,k=S,z=F,P=M,B=V;return q(),G(B,null,{default:t(()=>[e(P,{title:"Промо материалы",buttonText:"Добавить материал",buttonRoute:"/admin/promo/add"},{default:t(()=>[e(k,{ref_key:"tableRef",ref:d,"row-key":"id",data:i(r),style:{width:"100%"}},{default:t(()=>[e(u,{prop:"name",label:"Название",sortable:""}),e(u,{prop:"type",label:"Тип",sortable:"",width:"180","column-key":"type",filters:[{text:"Факт",value:"Факт"},{text:"Видео",value:"Видео"}],"filter-method":x}),e(u,{width:"160",align:"right"},{header:t(()=>[e(p,{size:"small",onClick:y},{default:t(()=>[H("Очистить фильтры")]),_:1})]),default:t(v=>[e(w,{to:`/admin/promo/${v.row.id}`},{default:t(()=>[e(p,{size:"small"},{default:t(()=>[e(g,null,{default:t(()=>[e(i(R))]),_:1})]),_:1})]),_:2},1032,["to"]),e(p,{class:"deleteProductBtn",size:"small",type:"danger",onClick:Q=>b(v.row.id)},{default:t(()=>[e(g,null,{default:t(()=>[e(i($))]),_:1})]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(z,{onSizeChange:C,onCurrentChange:E,"current-page":i(l),"page-size":i(a),layout:"prev, pager, next",total:i(s).length},null,8,["current-page","page-size","total"])]),_:1})]),_:1})}}});export{we as default};
